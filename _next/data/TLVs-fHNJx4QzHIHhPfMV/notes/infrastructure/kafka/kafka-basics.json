{"pageProps":{"noteKey":["infrastructure","kafka","kafka-basics"],"note":{"title":"Kafka Basics","date":"2022-08-18","content":"\n<p><code>Kafka</code> is an open source event streaming software, which allows to build event-driven applications.</p>\n<h2>Install On MacOs</h2>\n<p>To run <code>Kafka</code> you need to have <code>Java Runtime Environment</code>.</p>\n<pre><code class=\"hljs language-bash\">brew cask install java\nbrew install kafka\n</code></pre>\n<p>First need to run <code>Zookeeper</code>:</p>\n<pre><code class=\"hljs language-bash\">zookeeper-server-start /usr/local/etc/kafka/zookeeper.properties\n</code></pre>\n<p>Then start <code>Kafka</code>:</p>\n<pre><code class=\"hljs language-bash\">kafka-server-start /usr/local/etc/kafka/server.properties\n</code></pre>\n<h2>Install On Debian</h2>\n<p>Install JDK:</p>\n<pre><code class=\"hljs language-bash\">sudo apt install openjdk-17-jdk\n</code></pre>\n<p>Download kafka:</p>\n<pre><code class=\"hljs language-bash\">wget https://downloads.apache.org/kafka/&#x3C;version>/kafka_2.13-&#x3C;version>.tgz\n</code></pre>\n<p>Unpack downloaded Kafka archive and move it to the installation directory:</p>\n<pre><code class=\"hljs language-bash\">tar -xzf kafka_2.13-3.4.0.tgz\nsudo <span class=\"hljs-built_in\">mv</span> kafka_2.13-3.4.0 /usr/local/kafka\n</code></pre>\n<p>Create <code>systemctl</code> config for <code>zookeeper</code>:</p>\n<pre><code class=\"hljs language-bash\">sudo vim /etc/systemd/system/zookeeper.service\n</code></pre>\n<p>And fill it with:</p>\n<pre><code class=\"hljs language-ini\"><span class=\"hljs-section\">[Unit]</span>\n<span class=\"hljs-attr\">Description</span>=Apache Zookeeper server\n<span class=\"hljs-attr\">Documentation</span>=http://zookeeper.apache.org\n<span class=\"hljs-attr\">Requires</span>=network.target remote-fs.target\n<span class=\"hljs-attr\">After</span>=network.target remote-fs.target\n\n<span class=\"hljs-section\">[Service]</span>\n<span class=\"hljs-attr\">Type</span>=simple\n<span class=\"hljs-attr\">ExecStart</span>=/usr/local/kafka/bin/zookeeper-server-start.sh /usr/local/kafka/config/zookeeper.properties\n<span class=\"hljs-attr\">ExecStop</span>=/usr/local/kafka/bin/zookeeper-server-stop.sh\n<span class=\"hljs-attr\">Restart</span>=<span class=\"hljs-literal\">on</span>-abnormal\n\n<span class=\"hljs-section\">[Install]</span>\n<span class=\"hljs-attr\">WantedBy</span>=multi-user.target\n</code></pre>\n<p>Next create <code>systemctl</code> config for <code>Kafka</code>:</p>\n<pre><code class=\"hljs language-bash\">sudo vim /etc/systemd/system/kafka.service\n</code></pre>\n<p>And fill it with:</p>\n<pre><code class=\"hljs language-ini\"><span class=\"hljs-section\">[Unit]</span>\n<span class=\"hljs-attr\">Description</span>=Apache Kafka Server\n<span class=\"hljs-attr\">Documentation</span>=http://kafka.apache.org/documentation.html\n<span class=\"hljs-attr\">Requires</span>=zookeeper.service\n\n<span class=\"hljs-section\">[Service]</span>\n<span class=\"hljs-attr\">Type</span>=simple\n<span class=\"hljs-attr\">Environment</span>=<span class=\"hljs-string\">\"JAVA_HOME=&#x3C;insert path to java here>\"</span>\n<span class=\"hljs-attr\">ExecStart</span>=/usr/local/kafka/bin/kafka-server-start.sh /usr/local/kafka/config/server.properties\n<span class=\"hljs-attr\">ExecStop</span>=/usr/local/kafka/bin/kafka-server-stop.sh\n\n<span class=\"hljs-section\">[Install]</span>\n<span class=\"hljs-attr\">WantedBy</span>=multi-user.target\n</code></pre>\n<p>Reload <code>systemctl</code> daemon:</p>\n<pre><code class=\"hljs language-bash\">systemctl daemon-reload\n</code></pre>\n<p>and start services for <code>Zookeeper</code> and <code>Kafka</code>:</p>\n<pre><code class=\"hljs language-bash\">sudo systemctl start zookeeper\nsudo systemctl start kafka\n</code></pre>\n<p>To check it's status run:</p>\n<pre><code class=\"hljs language-bash\">sudo systemctl status kafka\n</code></pre>\n<h2>Running On VM:</h2>\n<p>\n  For <code>Kafka</code> to be accessible from outside of the VM, need to configure <code>advertised.listeners</code> to be public domain or IP address\n  in file <code>server.properties</code>\n</p>\n<h2>Basic Terminology</h2>\n<ul>\n  <li><code>Kafka broker</code>  —  one or more servers running Kafka nodes. Single <code>Kafka Cluster</code> is made of <code>brokers</code>.</li>\n  <li>\n    <code>Event</code> - is a message, which contains some information or simply alerts, that something happened.\n    Each event contains <code>key</code>, <code>value</code>, timestamp and some not mandatory metadata.\n  </li>\n  <li><code>Topic</code>  - stream or category to which event are published and organized.</li>\n  <li>\n    <code>Partition</code> - <code>topics</code> are divided into partitions, which may be spread across different <code>buckets</code>\n    on different brokers. Events with the same <code>key</code> will always be published to the same partition\n    ensuring with guarantee of event order in this partition.\n  </li>\n  <li><code>Producer</code> - application, which emits new events to Kafka instance.</li>\n  <li><code>Consumer</code> - application, which consumes and handles events from Kafka.</li>\n  <li><code>Consumer group</code> - group of consumers united by single <code>consumer id</code>. These consumers have same <code>offset</code>.</li>\n  <li><code>Offset</code> - number, used to persist current position in the topic or partition.</li>\n</ul>\n<p>\n  To operate <code>Kafka</code> requires <code>Zookeeper</code> application, which allows <code>Kafka cluster</code> to track nodes status,\n  maintain list of topics and event messages.\n</p>\n<p>\n  Each <code>topic</code> may have many <code>producers</code> and many <code>consumers</code>. Topics may be replicated across multiple brokers.\n  Event are not deleted after consumer consumption.\n</p>\n<h2>References</h2>\n<ul>\n  <li><a href=\"https://medium.com/@Ankitthakur/apache-kafka-installation-on-mac-using-homebrew-a367cdefd273\">https://medium.com/@Ankitthakur/apache-kafka-installation-on-mac-using-homebrew-a367cdefd273</a></li>\n  <li><a href=\"https://tecadmin.net/install-apache-kafka-debian/\">https://tecadmin.net/install-apache-kafka-debian/</a></li>\n</ul>\n"}},"__N_SSG":true}