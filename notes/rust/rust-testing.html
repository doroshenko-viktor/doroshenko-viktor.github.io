<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Rust - Testing Code</title><link rel="icon" href="/images/favicon.ico"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/b65b5b41f2379875.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b65b5b41f2379875.css" data-n-g=""/><link rel="preload" href="/_next/static/css/0d9654b911e08999.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0d9654b911e08999.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/_next/static/chunks/main-f4ae3437c92c1efc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-85d7488a393e293e.js" defer=""></script><script src="/_next/static/chunks/211-ca3cd870e26e881a.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5B...noteKey%5D-bc6552c3ae1e3718.js" defer=""></script><script src="/_next/static/IjqNhIRqaAJaH2DY5dkbz/_buildManifest.js" defer=""></script><script src="/_next/static/IjqNhIRqaAJaH2DY5dkbz/_ssgManifest.js" defer=""></script><script src="/_next/static/IjqNhIRqaAJaH2DY5dkbz/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><section class="Layout_centeredSection__nmU9U"><ul class="NavigationBar_navbar__CBMoV"><li class="NavigationBar_navitem__LKB5F"><a class="NavigationBar_navitemContent__jEyWq" href="/">Home</a><span class="NavigationBar_separator__qvEVD">|</span></li><li class="NavigationBar_navitem__LKB5F"><button class="NavigationBar_navitemContent__jEyWq">Back</button><span class="NavigationBar_separator__qvEVD">|</span></li></ul><h1 class="NoteFormattedContent_noteTitle__Oi9sD">Rust - Testing Code</h1><article class="NoteFormattedContent_note__8cHeE">
<h1>Rust Testing</h1>
<h2>Cargo Test</h2>
<p>To run single specified test case:</p>
<pre><code class="hljs language-bash">cargo <span class="hljs-built_in">test</span> &#x3C;test_case_name>
</code></pre>
<p>To run only tests from particular test file:</p>
<pre><code class="hljs language-bash">cargo <span class="hljs-built_in">test</span> --<span class="hljs-built_in">test</span> integration_test
</code></pre>
<p>Test with logs printed:</p>
<pre><code class="hljs language-bash">cargo <span class="hljs-built_in">test</span> -- --nocapture
</code></pre>
<h2>Unit Tests</h2>
<p>In Rust unit tests may be written alongside to the code under test.</p>
<p>To create test function you need to mark it with <code>#[test]</code> macro:</p>
<pre><code class="hljs language-rust"><span class="hljs-meta">#[test]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">test_1</span>() {
    <span class="hljs-comment">// ... test code</span>
}
</code></pre>
<p>Also several test cases could be organized into test module with <code>#[cfg(test)]</code>:</p>
<pre><code class="hljs language-rust"><span class="hljs-meta">#[cfg(test)]</span>
<span class="hljs-keyword">mod</span> tests {
    <span class="hljs-meta">#[test]</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">test_1</span>() {
        <span class="hljs-comment">// ... test code</span>
    }

    <span class="hljs-meta">#[test]</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">test_2</span>() {
        <span class="hljs-comment">// ... test code</span>
    }
}
</code></pre>
<p>
  <code>#[cfg(test)]</code> macro tells Rust compiler to build this module only when
  <code>cargo test</code> command is executed.
</p>
<p>
  Using test modules like that also allows to test private function, which are
  external to it. For example:
</p>
<pre><code class="hljs language-rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">private_function</span>() {
    <span class="hljs-comment">// some code</span>
}

<span class="hljs-keyword">mod</span> tests {
    <span class="hljs-keyword">use</span> super::private_function;

    <span class="hljs-meta">#[test]</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">test_1</span>() {
        <span class="hljs-comment">// test private_function here</span>
    }
}
</code></pre>
<h2>Integration Tests</h2>
<p>
  In Rust concept of <code>integration testing</code> means such kind of tests, which test behavior
  of our library from position of external user. Integration tests are checking correctness
  of the public API and all classes and functions working together.
</p>
<p>To create integration tests need to create <code>tests</code> directory in the root of the project:</p>
<pre><code class="hljs language-text">our_crate
├── Cargo.lock
├── Cargo.toml
├── src
│   └── lib.rs
└── tests
    └── integration_test.rs
</code></pre>
<p>
  Then we can create test in this folder and these tests may import <code>our_crate</code> as it will
  do it's final user:
</p>
<pre><code class="hljs language-rust"><span class="hljs-keyword">use</span> our_crate;

<span class="hljs-meta">#[test]</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">test_1</span>() {
    <span class="hljs-comment">// test some functionality from `our_crate`</span>
}
</code></pre>
<h2>References</h2>
<ul>
  <li><a href="https://doc.rust-lang.org/book/ch11-03-test-organization.html">Rust testing documentation</a></li>
</ul>
</article></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"noteKey":["rust","rust-testing"],"note":{"title":"Rust - Testing Code","date":"2022-03-02","content":"\n\u003ch1\u003eRust Testing\u003c/h1\u003e\n\u003ch2\u003eCargo Test\u003c/h2\u003e\n\u003cp\u003eTo run single specified test case:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecargo \u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e \u0026#x3C;test_case_name\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo run only tests from particular test file:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecargo \u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e --\u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e integration_test\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTest with logs printed:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ecargo \u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e -- --nocapture\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eUnit Tests\u003c/h2\u003e\n\u003cp\u003eIn Rust unit tests may be written alongside to the code under test.\u003c/p\u003e\n\u003cp\u003eTo create test function you need to mark it with \u003ccode\u003e#[test]\u003c/code\u003e macro:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-rust\"\u003e\u003cspan class=\"hljs-meta\"\u003e#[test]\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003epub\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efn\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003etest_1\u003c/span\u003e() {\n    \u003cspan class=\"hljs-comment\"\u003e// ... test code\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAlso several test cases could be organized into test module with \u003ccode\u003e#[cfg(test)]\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-rust\"\u003e\u003cspan class=\"hljs-meta\"\u003e#[cfg(test)]\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003emod\u003c/span\u003e tests {\n    \u003cspan class=\"hljs-meta\"\u003e#[test]\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003efn\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003etest_1\u003c/span\u003e() {\n        \u003cspan class=\"hljs-comment\"\u003e// ... test code\u003c/span\u003e\n    }\n\n    \u003cspan class=\"hljs-meta\"\u003e#[test]\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003efn\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003etest_2\u003c/span\u003e() {\n        \u003cspan class=\"hljs-comment\"\u003e// ... test code\u003c/span\u003e\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\n  \u003ccode\u003e#[cfg(test)]\u003c/code\u003e macro tells Rust compiler to build this module only when\n  \u003ccode\u003ecargo test\u003c/code\u003e command is executed.\n\u003c/p\u003e\n\u003cp\u003e\n  Using test modules like that also allows to test private function, which are\n  external to it. For example:\n\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-rust\"\u003e\u003cspan class=\"hljs-keyword\"\u003efn\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eprivate_function\u003c/span\u003e() {\n    \u003cspan class=\"hljs-comment\"\u003e// some code\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-keyword\"\u003emod\u003c/span\u003e tests {\n    \u003cspan class=\"hljs-keyword\"\u003euse\u003c/span\u003e super::private_function;\n\n    \u003cspan class=\"hljs-meta\"\u003e#[test]\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003efn\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003etest_1\u003c/span\u003e() {\n        \u003cspan class=\"hljs-comment\"\u003e// test private_function here\u003c/span\u003e\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eIntegration Tests\u003c/h2\u003e\n\u003cp\u003e\n  In Rust concept of \u003ccode\u003eintegration testing\u003c/code\u003e means such kind of tests, which test behavior\n  of our library from position of external user. Integration tests are checking correctness\n  of the public API and all classes and functions working together.\n\u003c/p\u003e\n\u003cp\u003eTo create integration tests need to create \u003ccode\u003etests\u003c/code\u003e directory in the root of the project:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-text\"\u003eour_crate\n├── Cargo.lock\n├── Cargo.toml\n├── src\n│   └── lib.rs\n└── tests\n    └── integration_test.rs\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\n  Then we can create test in this folder and these tests may import \u003ccode\u003eour_crate\u003c/code\u003e as it will\n  do it's final user:\n\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-rust\"\u003e\u003cspan class=\"hljs-keyword\"\u003euse\u003c/span\u003e our_crate;\n\n\u003cspan class=\"hljs-meta\"\u003e#[test]\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003efn\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003etest_1\u003c/span\u003e() {\n    \u003cspan class=\"hljs-comment\"\u003e// test some functionality from `our_crate`\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n  \u003cli\u003e\u003ca href=\"https://doc.rust-lang.org/book/ch11-03-test-organization.html\"\u003eRust testing documentation\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n"}},"__N_SSG":true},"page":"/notes/[...noteKey]","query":{"noteKey":["rust","rust-testing"]},"buildId":"IjqNhIRqaAJaH2DY5dkbz","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>