<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Node.Js Http</title><link rel="icon" href="/images/favicon.ico"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/b2e3df602701a6f2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b2e3df602701a6f2.css" data-n-g=""/><link rel="preload" href="/_next/static/css/ca60bdbe6d2fe4f6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ca60bdbe6d2fe4f6.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/_next/static/chunks/main-f4ae3437c92c1efc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-85d7488a393e293e.js" defer=""></script><script src="/_next/static/chunks/369-aaa550419eab31e8.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5B...noteKey%5D-c40409aa5ea3ea66.js" defer=""></script><script src="/_next/static/n5-cvnacXC5X9iqlHNVai/_buildManifest.js" defer=""></script><script src="/_next/static/n5-cvnacXC5X9iqlHNVai/_ssgManifest.js" defer=""></script><script src="/_next/static/n5-cvnacXC5X9iqlHNVai/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><section class="Layout_centeredSection__nmU9U"><div><a href="/"><header class="Header_mainHeader__VLamk Header_mainHeaderS__9KEas"><div class="Header_mainLogoImg__eX6Vr"><img src="/images/profile-pic.png" alt="logo"/></div><h1 class="Header_blogName__4JblC">Tech Notes</h1></header></a></div><h1 class="NoteFormattedContent_noteTitle__Oi9sD">Node.Js Http</h1><article class="NoteFormattedContent_note__8cHeE">
<p>Node.Js has rich <code>http</code> protocol support built in. Functions, related to serving <code>http</code> are gathered in <code>node:http</code> module.</p>
<p>To import it using <code>common-js</code>:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'node:http'</span>);
</code></pre>
<p>Or <code>es6</code> imports:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> http <span class="hljs-keyword">from</span> <span class="hljs-string">'node:http'</span>;
</code></pre>
<h2>Http Server</h2>
<p><code>http</code> module contains default implementation of an http server. To create simple version of it use <code>http.createServer</code>:</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(
  <span class="hljs-function">(<span class="hljs-params">req: IncomingMessage, res: ServerResponse</span>) =></span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`serving request: <span class="hljs-subst">${req.method}</span>: <span class="hljs-subst">${req.url}</span>`</span>);

    res.<span class="hljs-title function_">write</span>(<span class="hljs-string">"RESPONSE"</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =></span> {
      <span class="hljs-keyword">if</span> (err) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
      }
    });

    res.<span class="hljs-title function_">end</span>();
  }
);

server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">8000</span>, <span class="hljs-function">() =></span> { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"listening on port 8000"</span>); });
</code></pre>
<p>This code creates http server, which will listen for requests on port <code>8000</code>.</p>
<p>Here <code>createServer</code> has signature:</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createServer</span>(<span class="hljs-params">requestListener?: RequestListener</span>): <span class="hljs-title class_">Server</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">RequestListener</span> = <span class="hljs-function">(<span class="hljs-params">req: IncomingMessage, res: ServerResponse</span>) =></span> <span class="hljs-built_in">void</span>;
</code></pre>
<p>To parse url there is <code>node:url</code> module:</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">const</span> <span class="hljs-attr">reqUrl</span>: <span class="hljs-title class_">UrlWithParsedQuery</span> = url.<span class="hljs-title function_">parse</span>(req.<span class="hljs-property">url</span>, <span class="hljs-literal">true</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(reqUrl.<span class="hljs-property">pathname</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> val <span class="hljs-keyword">in</span> reqUrl.<span class="hljs-property">query</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`<span class="hljs-subst">${val}</span> => <span class="hljs-subst">${reqUrl.query[val]}</span>`</span>);
}
</code></pre>
<p>where <code>UrlWithParsedQuery</code>:</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Url</span> {
    <span class="hljs-attr">auth</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
    <span class="hljs-attr">hash</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
    <span class="hljs-attr">host</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
    <span class="hljs-attr">hostname</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
    <span class="hljs-attr">href</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">path</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
    <span class="hljs-attr">pathname</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
    <span class="hljs-attr">protocol</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
    <span class="hljs-attr">search</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
    <span class="hljs-attr">slashes</span>: <span class="hljs-built_in">boolean</span> | <span class="hljs-literal">null</span>;
    <span class="hljs-attr">port</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
    <span class="hljs-attr">query</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span> | <span class="hljs-title class_">ParsedUrlQuery</span>;
}
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">UrlWithParsedQuery</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Url</span> {
    <span class="hljs-attr">query</span>: <span class="hljs-title class_">ParsedUrlQuery</span>;
}
</code></pre>
<p><strong>Simple html server example:</strong></p>
<p>Let's create a simple implementation of an <code>html</code> server, which will serve <code>html</code> file depending on url path.</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">import</span> http, { <span class="hljs-title class_">IncomingMessage</span>, <span class="hljs-title class_">ServerResponse</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:http"</span>;
<span class="hljs-keyword">import</span> url, { <span class="hljs-title class_">UrlWithParsedQuery</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:url"</span>;
<span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">"node:fs"</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">"node:path"</span>;

<span class="hljs-comment">// this function constructs path in local file system </span>
<span class="hljs-comment">// to locate particular html file by url path</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">getServedFileName</span> = (<span class="hljs-params">requestPath: <span class="hljs-built_in">string</span></span>) => {
  <span class="hljs-keyword">if</span> (requestPath === <span class="hljs-string">"/"</span>) {
    <span class="hljs-keyword">return</span> path.<span class="hljs-title function_">join</span>(<span class="hljs-string">".."</span>, <span class="hljs-string">"public"</span>, <span class="hljs-string">"index.html"</span>);
  }
  <span class="hljs-keyword">return</span> path.<span class="hljs-title function_">join</span>(<span class="hljs-string">".."</span>, <span class="hljs-string">"public"</span>, <span class="hljs-string">`<span class="hljs-subst">${requestPath}</span>.html`</span>);
};

<span class="hljs-comment">// creating http server</span>
<span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(
  <span class="hljs-function">(<span class="hljs-params">req: IncomingMessage, res: ServerResponse</span>) =></span> {
    <span class="hljs-keyword">if</span> (!req.<span class="hljs-property">url</span>) {
      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">400</span>, <span class="hljs-string">"Bad request"</span>);
      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">end</span>();
    }

    <span class="hljs-keyword">const</span> <span class="hljs-attr">requestUrl</span>: <span class="hljs-title class_">UrlWithParsedQuery</span> = url.<span class="hljs-title function_">parse</span>(req.<span class="hljs-property">url</span>, <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">const</span> requestPath = requestUrl.<span class="hljs-property">pathname</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"serving: "</span> + requestPath);

    <span class="hljs-keyword">if</span> (!requestPath) {
      res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">400</span>, <span class="hljs-string">"Bad request"</span>);
      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">end</span>();
    }

    <span class="hljs-comment">// generate path to correct html page file</span>
    <span class="hljs-keyword">const</span> fileName = <span class="hljs-title function_">getServedFileName</span>(requestPath);

    <span class="hljs-comment">// reading file from local file system</span>
    fs.<span class="hljs-title function_">readFile</span>(fileName, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =></span> {
      <span class="hljs-keyword">if</span> (err) {
        res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">500</span>, <span class="hljs-string">"Server error"</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">end</span>();
      }

      res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, <span class="hljs-string">"OK"</span>);
      res.<span class="hljs-title function_">write</span>(data, <span class="hljs-function">(<span class="hljs-params">err</span>) =></span> {
        <span class="hljs-keyword">if</span> (err) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error serving request <span class="hljs-subst">${err}</span>`</span>);
        }
      });
      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">end</span>();
    });
  }
);

<span class="hljs-comment">// starting the server</span>
server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">8000</span>, <span class="hljs-function">() =></span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"listening on port 8000"</span>);
});
</code></pre>
<p>
  This implementation assumes, that <code>html</code> files are placed in a folder named <code>public</code>, which located
  one level up from our running server.
</p>
<h2>HTTP Requests</h2>
<p>Node.Js <code>http</code> module has an ability to perform <code>HTTP</code> requests. To do this, use <code>http.request</code> function.</p>
<p>For example:</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">function</span> makeRawHttpRequest&#x3C;T>(
  <span class="hljs-attr">host</span>: <span class="hljs-built_in">string</span>,
  <span class="hljs-attr">urlPath</span>: <span class="hljs-built_in">string</span>
): <span class="hljs-title class_">Promise</span>&#x3C;T> {
  <span class="hljs-keyword">const</span> options = {
    <span class="hljs-attr">hostname</span>: host,
    <span class="hljs-attr">path</span>: urlPath,
    <span class="hljs-attr">method</span>: <span class="hljs-string">"GET"</span>,
  };

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&#x3C;T>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {
    http
      .<span class="hljs-title function_">request</span>(options, <span class="hljs-function">(<span class="hljs-params">res</span>) =></span> {
        <span class="hljs-keyword">let</span> data = <span class="hljs-string">""</span>;

        res.<span class="hljs-title function_">on</span>(<span class="hljs-string">"data"</span>, <span class="hljs-function">(<span class="hljs-params">chunk</span>) =></span> {
          data += chunk;
        });

        res.<span class="hljs-title function_">on</span>(<span class="hljs-string">"end"</span>, <span class="hljs-function">() =></span> {
          <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data) <span class="hljs-keyword">as</span> T;
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Body:"</span>, result);
          <span class="hljs-title function_">resolve</span>(result);
        });
      })
      .<span class="hljs-title function_">on</span>(<span class="hljs-string">"error"</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =></span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Error: "</span>, err);
        <span class="hljs-title function_">reject</span>(err);
      })
      .<span class="hljs-title function_">end</span>();
  });
}
</code></pre>
<p>
  But this requires some boilerplate code to manually handle stream events and parse data.
  There are many third party libraries, like <code>axios</code>, which simplify this process.
</p>
<h2>Plan</h2>
<ul>
  <li>http2</li>
  <li>https</li>
  <li>axios</li>
</ul>
</article></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"noteKey":["javascript","Node.Js","node-http"],"note":{"title":"Node.Js Http","date":"2022-04-26","content":"\n\u003cp\u003eNode.Js has rich \u003ccode\u003ehttp\u003c/code\u003e protocol support built in. Functions, related to serving \u003ccode\u003ehttp\u003c/code\u003e are gathered in \u003ccode\u003enode:http\u003c/code\u003e module.\u003c/p\u003e\n\u003cp\u003eTo import it using \u003ccode\u003ecommon-js\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e http = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'node:http'\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOr \u003ccode\u003ees6\u003c/code\u003e imports:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e http \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'node:http'\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eHttp Server\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ehttp\u003c/code\u003e module contains default implementation of an http server. To create simple version of it use \u003ccode\u003ehttp.createServer\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e server = http.\u003cspan class=\"hljs-title function_\"\u003ecreateServer\u003c/span\u003e(\n  \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003ereq: IncomingMessage, res: ServerResponse\u003c/span\u003e) =\u003e\u003c/span\u003e {\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003einfo\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e`serving request: \u003cspan class=\"hljs-subst\"\u003e${req.method}\u003c/span\u003e: \u003cspan class=\"hljs-subst\"\u003e${req.url}\u003c/span\u003e`\u003c/span\u003e);\n\n    res.\u003cspan class=\"hljs-title function_\"\u003ewrite\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"RESPONSE\"\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eerr\u003c/span\u003e) =\u003e\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (err) {\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(err);\n      }\n    });\n\n    res.\u003cspan class=\"hljs-title function_\"\u003eend\u003c/span\u003e();\n  }\n);\n\nserver.\u003cspan class=\"hljs-title function_\"\u003elisten\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e8000\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e { \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"listening on port 8000\"\u003c/span\u003e); });\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis code creates http server, which will listen for requests on port \u003ccode\u003e8000\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eHere \u003ccode\u003ecreateServer\u003c/code\u003e has signature:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003ecreateServer\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003erequestListener?: RequestListener\u003c/span\u003e): \u003cspan class=\"hljs-title class_\"\u003eServer\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eRequestListener\u003c/span\u003e = \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003ereq: IncomingMessage, res: ServerResponse\u003c/span\u003e) =\u003e\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003evoid\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo parse url there is \u003ccode\u003enode:url\u003c/code\u003e module:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ereqUrl\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eUrlWithParsedQuery\u003c/span\u003e = url.\u003cspan class=\"hljs-title function_\"\u003eparse\u003c/span\u003e(req.\u003cspan class=\"hljs-property\"\u003eurl\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e);\n\u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003einfo\u003c/span\u003e(reqUrl.\u003cspan class=\"hljs-property\"\u003epathname\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e val \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e reqUrl.\u003cspan class=\"hljs-property\"\u003equery\u003c/span\u003e) {\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003einfo\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e`\u003cspan class=\"hljs-subst\"\u003e${val}\u003c/span\u003e =\u003e \u003cspan class=\"hljs-subst\"\u003e${reqUrl.query[val]}\u003c/span\u003e`\u003c/span\u003e);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ewhere \u003ccode\u003eUrlWithParsedQuery\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003einterface\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUrl\u003c/span\u003e {\n    \u003cspan class=\"hljs-attr\"\u003eauth\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n    \u003cspan class=\"hljs-attr\"\u003ehash\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n    \u003cspan class=\"hljs-attr\"\u003ehost\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n    \u003cspan class=\"hljs-attr\"\u003ehostname\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n    \u003cspan class=\"hljs-attr\"\u003ehref\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n    \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n    \u003cspan class=\"hljs-attr\"\u003epathname\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n    \u003cspan class=\"hljs-attr\"\u003eprotocol\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n    \u003cspan class=\"hljs-attr\"\u003esearch\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n    \u003cspan class=\"hljs-attr\"\u003eslashes\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003eboolean\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n    \u003cspan class=\"hljs-attr\"\u003eport\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n    \u003cspan class=\"hljs-attr\"\u003equery\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e | \u003cspan class=\"hljs-title class_\"\u003eParsedUrlQuery\u003c/span\u003e;\n}\n\u003cspan class=\"hljs-keyword\"\u003einterface\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUrlWithParsedQuery\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUrl\u003c/span\u003e {\n    \u003cspan class=\"hljs-attr\"\u003equery\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eParsedUrlQuery\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eSimple html server example:\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eLet's create a simple implementation of an \u003ccode\u003ehtml\u003c/code\u003e server, which will serve \u003ccode\u003ehtml\u003c/code\u003e file depending on url path.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e http, { \u003cspan class=\"hljs-title class_\"\u003eIncomingMessage\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eServerResponse\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"node:http\"\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e url, { \u003cspan class=\"hljs-title class_\"\u003eUrlWithParsedQuery\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"node:url\"\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e fs \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"node:fs\"\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e path \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"node:path\"\u003c/span\u003e;\n\n\u003cspan class=\"hljs-comment\"\u003e// this function constructs path in local file system \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// to locate particular html file by url path\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003egetServedFileName\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003erequestPath: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\u003c/span\u003e) =\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (requestPath === \u003cspan class=\"hljs-string\"\u003e\"/\"\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e path.\u003cspan class=\"hljs-title function_\"\u003ejoin\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"..\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"public\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"index.html\"\u003c/span\u003e);\n  }\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e path.\u003cspan class=\"hljs-title function_\"\u003ejoin\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"..\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"public\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e`\u003cspan class=\"hljs-subst\"\u003e${requestPath}\u003c/span\u003e.html`\u003c/span\u003e);\n};\n\n\u003cspan class=\"hljs-comment\"\u003e// creating http server\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e server = http.\u003cspan class=\"hljs-title function_\"\u003ecreateServer\u003c/span\u003e(\n  \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003ereq: IncomingMessage, res: ServerResponse\u003c/span\u003e) =\u003e\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!req.\u003cspan class=\"hljs-property\"\u003eurl\u003c/span\u003e) {\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e res.\u003cspan class=\"hljs-title function_\"\u003ewriteHead\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Bad request\"\u003c/span\u003e);\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e res.\u003cspan class=\"hljs-title function_\"\u003eend\u003c/span\u003e();\n    }\n\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003erequestUrl\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eUrlWithParsedQuery\u003c/span\u003e = url.\u003cspan class=\"hljs-title function_\"\u003eparse\u003c/span\u003e(req.\u003cspan class=\"hljs-property\"\u003eurl\u003c/span\u003e, \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e requestPath = requestUrl.\u003cspan class=\"hljs-property\"\u003epathname\u003c/span\u003e;\n    \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003einfo\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"serving: \"\u003c/span\u003e + requestPath);\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!requestPath) {\n      res.\u003cspan class=\"hljs-title function_\"\u003ewriteHead\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e400\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Bad request\"\u003c/span\u003e);\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e res.\u003cspan class=\"hljs-title function_\"\u003eend\u003c/span\u003e();\n    }\n\n    \u003cspan class=\"hljs-comment\"\u003e// generate path to correct html page file\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e fileName = \u003cspan class=\"hljs-title function_\"\u003egetServedFileName\u003c/span\u003e(requestPath);\n\n    \u003cspan class=\"hljs-comment\"\u003e// reading file from local file system\u003c/span\u003e\n    fs.\u003cspan class=\"hljs-title function_\"\u003ereadFile\u003c/span\u003e(fileName, \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eerr, data\u003c/span\u003e) =\u003e\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (err) {\n        res.\u003cspan class=\"hljs-title function_\"\u003ewriteHead\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e500\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Server error\"\u003c/span\u003e);\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(err);\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e res.\u003cspan class=\"hljs-title function_\"\u003eend\u003c/span\u003e();\n      }\n\n      res.\u003cspan class=\"hljs-title function_\"\u003ewriteHead\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"OK\"\u003c/span\u003e);\n      res.\u003cspan class=\"hljs-title function_\"\u003ewrite\u003c/span\u003e(data, \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eerr\u003c/span\u003e) =\u003e\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (err) {\n          \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e`Error serving request \u003cspan class=\"hljs-subst\"\u003e${err}\u003c/span\u003e`\u003c/span\u003e);\n        }\n      });\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e res.\u003cspan class=\"hljs-title function_\"\u003eend\u003c/span\u003e();\n    });\n  }\n);\n\n\u003cspan class=\"hljs-comment\"\u003e// starting the server\u003c/span\u003e\nserver.\u003cspan class=\"hljs-title function_\"\u003elisten\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e8000\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"listening on port 8000\"\u003c/span\u003e);\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\n  This implementation assumes, that \u003ccode\u003ehtml\u003c/code\u003e files are placed in a folder named \u003ccode\u003epublic\u003c/code\u003e, which located\n  one level up from our running server.\n\u003c/p\u003e\n\u003ch2\u003eHTTP Requests\u003c/h2\u003e\n\u003cp\u003eNode.Js \u003ccode\u003ehttp\u003c/code\u003e module has an ability to perform \u003ccode\u003eHTTP\u003c/code\u003e requests. To do this, use \u003ccode\u003ehttp.request\u003c/code\u003e function.\u003c/p\u003e\n\u003cp\u003eFor example:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e makeRawHttpRequest\u0026#x3C;T\u003e(\n  \u003cspan class=\"hljs-attr\"\u003ehost\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003eurlPath\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e\n): \u003cspan class=\"hljs-title class_\"\u003ePromise\u003c/span\u003e\u0026#x3C;T\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e options = {\n    \u003cspan class=\"hljs-attr\"\u003ehostname\u003c/span\u003e: host,\n    \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e: urlPath,\n    \u003cspan class=\"hljs-attr\"\u003emethod\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"GET\"\u003c/span\u003e,\n  };\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePromise\u003c/span\u003e\u0026#x3C;T\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eresolve, reject\u003c/span\u003e) =\u003e\u003c/span\u003e {\n    http\n      .\u003cspan class=\"hljs-title function_\"\u003erequest\u003c/span\u003e(options, \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eres\u003c/span\u003e) =\u003e\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e data = \u003cspan class=\"hljs-string\"\u003e\"\"\u003c/span\u003e;\n\n        res.\u003cspan class=\"hljs-title function_\"\u003eon\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"data\"\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003echunk\u003c/span\u003e) =\u003e\u003c/span\u003e {\n          data += chunk;\n        });\n\n        res.\u003cspan class=\"hljs-title function_\"\u003eon\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"end\"\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e {\n          \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e result = \u003cspan class=\"hljs-title class_\"\u003eJSON\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eparse\u003c/span\u003e(data) \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e T;\n          \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Body:\"\u003c/span\u003e, result);\n          \u003cspan class=\"hljs-title function_\"\u003eresolve\u003c/span\u003e(result);\n        });\n      })\n      .\u003cspan class=\"hljs-title function_\"\u003eon\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"error\"\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eerr\u003c/span\u003e) =\u003e\u003c/span\u003e {\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Error: \"\u003c/span\u003e, err);\n        \u003cspan class=\"hljs-title function_\"\u003ereject\u003c/span\u003e(err);\n      })\n      .\u003cspan class=\"hljs-title function_\"\u003eend\u003c/span\u003e();\n  });\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\n  But this requires some boilerplate code to manually handle stream events and parse data.\n  There are many third party libraries, like \u003ccode\u003eaxios\u003c/code\u003e, which simplify this process.\n\u003c/p\u003e\n\u003ch2\u003ePlan\u003c/h2\u003e\n\u003cul\u003e\n  \u003cli\u003ehttp2\u003c/li\u003e\n  \u003cli\u003ehttps\u003c/li\u003e\n  \u003cli\u003eaxios\u003c/li\u003e\n\u003c/ul\u003e\n"}},"__N_SSG":true},"page":"/notes/[...noteKey]","query":{"noteKey":["javascript","Node.Js","node-http"]},"buildId":"n5-cvnacXC5X9iqlHNVai","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>